---
title: （转）为什么 C 语言源程序最后一行要是一个空行？
date: 2017-02-14
tag:
  - C++
category: C++
---

**作者：pansz**

**链接：https://www.zhihu.com/question/20018991/answer/15239139**

**来源：知乎**

C 语言是在 `Unix` 中发明的，为 `Unix` 系统的编程语言，它对文件的处理遵循一个基本的原则：
文件是流式的，可以被任意的拼接并且拼接后仍然保证完整性。
为了保证这一点，在 `Unix` 中 `\n` 符号被定义为一行的『结束符』，换句话说，如果一行的结尾没有 `\n` 视为这一行没有结束，换句话说这个文件不完整，也就是说这根本不是一个合法的文本文件。

（题外话：同时为了保证这一点，`Unix` 文本通常不允许使用 `BOM`，因为 `BOM` 拼接之后将出现在字符流的中间位置，无法有效的定义其处理方法。）

在 `Windows` 中，微软把 `\n` 定义为两行之间的『分隔符』而非结束符，所以 `Unix` 文件结尾的 `\n` ，在 `Windows` 看起来就是一个空行，而这一个空行在 `Unix` 中并不存在，如果你使用 `Vim` 之类的文本编辑器，会根本看不到最后这个空行。

不遵守标准会带来的问题是：如果 `\n` 是两行之间的分隔符，那么最后一行不带 `\n`，结果是拼接两个文件时，后一个文件的第一行就会被拼到前一个文件的最后一行，这很可能会造成语意错误。

比较常见的例子是：
前一个文件最后一行是 `}` 后一个文件第一行是 `#include`，如果 `}` 后面没有结束符，拼接之后就成了 `}#include` ，立即发生语法错误。
